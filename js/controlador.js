///-----------------------------------------------USUARIOS
var usuarios = [{
        nombre: "Pedro",
        apellido: "Martinez",
        ordenes: [{
                nombreProducto: "Producto 1",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad: 2,
                precio: 49.99
            },
            {
                nombreProducto: "Producto 2",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad: 2,
                precio: 49.99
            }
        ]
    },
    {
        nombre: "Juan",
        apellido: "Perez",
        ordenes: [{
                nombreProducto: "Producto 3",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad: 2,
                precio: 49.99
            },
            {
                nombreProducto: "",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad: 2,
                precio: 49.99
            }
        ]
    },
    {
        nombre: "Maria",
        apellido: "Rodriguez",
        ordenes: [{
                nombreProducto: "Producto 4",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad: 2,
                precio: 49.99
            },
            {
                nombreProducto: "Producto 1",
                descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                cantidad: 2,
                precio: 49.99
            }
        ]
    }
];


///-----------------------------------------------CATEGORIAS
var categorias = [{
        nombreCategoria: "Farmacias",
        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color: "#fadb54",
        icono: "fas fa-first-aid",
        empresas: [{
                nombreEmpresa: "Empresa 1",
                imagen: "img/Farmacia 1.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen: "img/Farmacia 2.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen: "img/Farmacia 3.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    },
    {
        nombreCategoria: "Restaurantes",
        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color: "#f3adac",
        icono: "fas fa-utensils",
        empresas: [{
                nombreEmpresa: "Empresa 1",
                imagen: "img/restaurante-1jpg.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen: "img/Restaurante-2.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    },
    {
        nombreCategoria: "Salud",
        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color: "#d98f6d",
        icono: "fas fa-hospital",
        empresas: [{
                nombreEmpresa: "Empresa 1",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    },
    {
        nombreCategoria: "Caf√©",
        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color: "#9482C4",
        icono: "fas fa-coffee",
        empresas: [{
                nombreEmpresa: "Empresa 1",
                imagen: "img/Cafe-1.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    },
    {
        nombreCategoria: "Bebidas",
        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
        color: "#9482C4",
        icono: "fas fa-glass-cheers",
        empresas: [{
                nombreEmpresa: "Empresa 1",
                imagen: "img/bebidas-1.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 2",
                imagen: "img/bebida-2.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            },
            {
                nombreEmpresa: "Empresa 3",
                imagen: "img/banner.jpg",
                productos: [{
                        nombreProducto: "Producto 1",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 2",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 3",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    },
                    {
                        nombreProducto: "Producto 4",
                        descripcion: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dolore, modi!",
                        precio: 49.99
                    }
                ]
            }
        ]
    }
];

console.log('Usuarios', usuarios);
console.log('Categorias', categorias);
// LocalStorage

var localStorage = window.localStorage;
localStorage.clear
for (i = 0; i < categorias.length; i++) {
    localStorage.setItem('categorias', JSON.stringify(categorias));

}
for (j = 0; j < usuarios.length; j++) {
    localStorage.setItem('usuarios', JSON.stringify(usuarios));

}
let categoria = JSON.parse(localStorage.getItem('categorias'));
let usuario = JSON.parse(localStorage.getItem('usuarios'));

console.log('Las categorias a mostrar son:', categoria);
console.log('Los usuarios a mostrar son:', usuario);
//


//Ocupo una funcion que se generen las cards de Lugo
// Funcion para generar categorias


function generarCategorias() {
    let categoria = JSON.parse(localStorage.getItem('categorias'));
    document.getElementById('categorias').innerHTML = ``;
    for (let i = 0; i < categoria.length; i++) {

        document.getElementById('categorias').innerHTML += `
        <div class="col-lg-3 col-md-4 col-sm-6 mt-2">
            <div class="card-item card" style="background-color: ${categoria[i].color};" onclick="detalleCategoria(${i})">
                <div class="row">
                    <div class="col mx-auto text-center m-3">
                        <i class="${categoria[i].icono} fa-4x"></i>
                    </div>
                    <div class="col">

                    </div>
                </div>
                <div class="row m-3 mt-4">
                    <section class="col">
                        <h3 class="text-white font-weight-bolder">${categoria[i].nombreCategoria}</h3>
                        <p class="text-white" style="font-size: 13px;">
                            ${categoria[i].empresas.length} Comercios
                        </p>
                    </section>
                </div>
            </div>
        </div>
        `;
    }
}
generarCategorias();

// Generar la lista de usuarios

function verUsuario() {
    let usuario = JSON.parse(localStorage.getItem('usuarios'));
    for (let i = 0; i < usuario.length; i++) {
        document.getElementById('usuarioSeleccionado').innerHTML +=
            `<option value="${i}">${usuario[i].nombre} ${usuario[i].apellido}</option>`
    }
}

verUsuario();

// Cambiar de usuario

function cambiarUsuario() {
    let usuarioActivo = document.querySelector('#usuarioSeleccionado').value;
    document.getElementById('texto-inicio').innerHTML = `Hola ${usuario[usuarioActivo].nombre}`;
    return usuarioActivo;
}

// Funcion para ordenes de usuario

function mirarOrdenes() {
    let usuarioCambiar = cambiarUsuario();
    let usuario = JSON.parse(localStorage.getItem('usuarios'));
    console.log('Las ordenes del usuario:', usuario);
    document.querySelector('#modalUsuarioLabel').innerHTML = `${usuario[usuarioCambiar].nombre} , Estos Son Tus Pedidos Realizados.`;
    // Zona de Productos
    console.log(usuario[usuarioCambiar].ordenes.length);
    document.querySelector('#cuerpoProductos').innerHTML = '';
    for (let i = 0; i < usuario[usuarioCambiar].ordenes.length; i++) {
        let pago = usuario[usuarioCambiar].ordenes[i].precio * usuario[usuarioCambiar].ordenes[i].cantidad;
        document.querySelector('#cuerpoProductos').innerHTML += `
            <p>
                <h3 style="color: #563D7C; font-weight: bold;">${ usuario[usuarioCambiar].ordenes[i].nombreProducto }</h3>
            </p>
            <p style="font-size: 18px;">
                ${usuario[usuarioCambiar].ordenes[i].descripcion}
            </p>
            <p class="ml-auto">
                <b style="font-size: 25px">$${pago}</b>
            </p>
            <hr>
        `;
    }

}

// Crear funcion para mostrar la informacion de las categorias
function detalleCategoria(idCategoria) {
    let categoria = JSON.parse(localStorage.getItem('categorias'));
    let titulo = categoria[idCategoria].nombreCategoria;
    $('#modalDetalle').modal('show');
    document.getElementById('cuerpo-categorias').innerHTML = ``;
    document.getElementById('titulo-detalle').innerHTML = `${titulo}`;

    //console.log(categorias[idCategoria].nombreCategoria);
    //console.log('Que recibe', categoria[idCategoria].nombreCategoria);
    let categoriaSeleccionada = categoria[idCategoria];
    for (let i = 0; i < categoriaSeleccionada.empresas.length; i++) {
        const detalleProductos = categoriaSeleccionada.empresas[i];
        console.log('Las empresas son:', detalleProductos.nombreEmpresa);
        let productos = '';
        for (let j = 0; j < detalleProductos.productos.length; j++) {
            productos += `
                    <div class="row p-2">
                        <div class="col-lg-7">
                            <h4>${ detalleProductos.productos[j].nombreProducto }</h4>
                        </div>
                        <div class="col-lg-5">
                            <input type="button" class="btn btn-secondary" onclick="realizarPedido(${ idCategoria } , ${ i } ,${ j })" value="Pedir">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-8">
                            <p>${ detalleProductos.productos[j].descripcion }</p>
                        </div>
                        <div class="col-lg-4 ml-auto">
                            <b>$ ${ detalleProductos.productos[j].precio }</b>
                        </div>
                    </div>
                    
                `;
        }
        document.getElementById('cuerpo-categorias').innerHTML += `
                <div class="col-lg-6 col-sm-12 mt-2">
                    <div class="card">
                        <section>
                            <img src="${detalleProductos.imagen}" class="img-fluid my-2" >
                            <h3 class="text-center" style="color: black; font-weight:bolder;">${detalleProductos.nombreEmpresa}</h3>
                        </section>
                        <section class="p-3">
                            ${ productos }
                        </section>
                    </div>
                </div>
            `;
    }
};

// Funcion para realizar un pedido

function realizarPedido(idCategoria, idEmpresa, idProducto) {
    console.log(idEmpresa);
    console.log(idProducto);
    console.log(idCategoria);
    $('#modalPedidosDetalle').modal('show');
    const ped = categorias[idCategoria].empresas[idEmpresa].productos[idProducto];
    var nombrePro = ped.nombreProducto;
    var descrip = ped.descripcion;
    var valu2 = ped.precio;
    document.getElementById('cuerpo-pedidos').innerHTML =
        `
        <h3 class="text-center" style="color: black; font-weight:bolder;">
            ${nombrePro}
        </h3>
        <br>
        <p>
        ${ descrip }
        </p>
        <br>
        <div class="row">
            <div class="col-lg-4">
                Ingrese la cantidad a solicitar : 
            </div>
            <div class="col-lg-8">
                <input type="text" class="form-control" id="cantidad-ingresada" />    
            </div>
        </div>
        <div class="row">
            <div class="col-lg-10 mr-auto">
                
            </div>
            <div class="col-lg-2"><br>
            <b>$ ${ valu2 }</b>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" onclick="nuevoPedido('${nombrePro}','${descrip}',${valu2})" 
            class="btn btn-secondary">
            Procesar Orden</button>
        </div>
    `;
}


// Funcion para realizaer el pedido
function nuevoPedido(nombrePro, descrip, valu2) {
    let cantidad = document.getElementById('cantidad-ingresada').value;
    let usuario = cambiarUsuario();
    const orden = {
        nombreProducto: nombrePro,
        descripcion: descrip,
        cantidad: cantidad,
        precio: valu2
    }
    usuarios[usuario].ordenes.push(orden);
    localStorage.setItem('usuarios', JSON.stringify(usuarios));
    generarCategorias();

    $('#modalPedidosDetalle').modal('hide');
    $('#modalDetalle').modal('hide');



}
// Funcion para un nuevo formulario 
function crearCategoria() {
    $('#modalPedidosDetalle').modal('hide');
    $('#modalDetalle').modal('hide');
    $('#modalNuevaCategoria').modal('show');

}
// Cerrar la ventana modal con el boton
function botonCerrar() {
    $('#modalDetalle').modal('hide');
}